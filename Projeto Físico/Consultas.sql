-- QUANTIDADE DE CONQUISTAS PLATINA POR CONTA QUE TENHAM MAIS QUE A MEDIA (GROUP BY HAVING)--
SELECT G.USERNAME_LOGADO, COUNT(*) AS QTD
FROM GANHAR G
WHERE (G.NOME_APP, G.NOME_CONQUISTA) IN (SELECT C.NOME_APP, C.NOME_CONQUISTA FROM CONQUISTA C WHERE C.RARIDADE = 'PLATINA')
GROUP BY G.USERNAME_LOGADO
HAVING QTD > AVG(QTD);
